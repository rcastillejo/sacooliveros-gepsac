--Datos Entrada
delete from tp_alumno_evaluado where cod_alumno between 'A201500101' and 'A201500137';

--Agresor
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500101', '1', '15', '2', '3', '2', '1', '0', '2', '5', '10', '4', '1', '1', '3', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500102', '1', '14', '2', '2', '3', '2', '2', '2', '4', '10.5', '2', '0', '1', '2', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500103', '1', '13', '2', '3', '3', '3', '3', '2', '4', '11', '2', '1', '1', '1', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500104', '1', '10', '2', '3', '4', '2', '4', '1', '6', '12', '1', '0', '1', '4', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500105', '1', '12', '2', '3', '2', '1', '0', '2', '2', '13', '2', '1', '1', '5', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500106', '1', '15', '2', '3', '4', '1', '0', '2', '3', '11', '3', '0', '1', '1', '1', '1', 'P0001','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500107', '1', '16', '2', '3', '3', '2', '1', '2', '5', '13', '2', '1', '1', '1', '1', '1', 'P0001','ALU0002');

--Victima
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500108', '1', '14', '1', '2', '3', '3', '3', '2', '4', '12', '2', '1', '1', '1', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500109', '1', '13', '3', '1', '1', '1', '2', '2', '4', '13', '2', '1', '1', '3', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500110', '1', '13', '1', '1', '2', '1', '0', '2', '3', '12.5', '1', '1', '1', '2', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500111', '1', '12', '2', '2', '4', '2', '3', '2', '2', '13', '2', '1', '1', '4', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500112', '1', '15', '1', '3', '2', '2', '2', '2', '5', '11', '2', '1', '1', '5', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500113', '1', '14', '1', '2', '3', '3', '3', '2', '4', '12', '2', '2', '1', '1', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500114', '1', '13', '3', '2', '4', '1', '2', '2', '4', '13', '2', '3', '1', '3', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500115', '1', '13', '1', '1', '2', '1', '0', '2', '3', '12.5', '1', '2', '1', '2', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500116', '1', '12', '2', '1', '2', '2', '3', '2', '2', '13', '2', '0', '1', '4', '1', '1', 'P0002','ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500117', '1', '15', '1', '3', '2', '2', '2', '2', '5', '11', '2', '2', '1', '5', '1', '1', 'P0002','ALU0002');

--Testigo
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500118', '2', '15', '2', '2', '3', '3', '2', '2', '5', '18', '4', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500119', '2', '15', '2', '2', '3', '1', '2', '2', '4', '17.5', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500120', '2', '15', '2', '2', '3', '1', '3', '2', '4', '17', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500121', '2', '15', '2', '2', '3', '2', '2', '1', '6', '17', '1', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500122', '2', '15', '2', '2', '3', '1', '2', '2', '2', '17', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500123', '2', '16', '2', '2', '3', '1', '2', '2', '3', '17', '3', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500124', '2', '16', '2', '2', '3', '2', '3', '2', '5', '17', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500125', '2', '16', '2', '2', '3', '1', '2', '2', '4', '18.5', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500126', '2', '16', '2', '2', '3', '1', '3', '2', '4', '18', '2', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500127', '2', '16', '2', '2', '3', '2', '2', '1', '6', '18', '1', '0', '1', '5', '1', '1', 'P0003', 'ALU0002');

--No Identificado
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500128', '2', '11', '3', '3', '1', '3', '2', '2', '5', '18', '4', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500129', '2', '11', '3', '3', '1', '1', '2', '2', '4', '17.5', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500130', '2', '11', '3', '3', '1', '1', '3', '2', '4', '17', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500131', '2', '11', '3', '3', '1', '2', '2', '1', '6', '17', '1', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500132', '2', '11', '3', '3', '1', '1', '2', '2', '2', '17', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500133', '2', '12', '3', '3', '1', '1', '2', '2', '3', '17', '3', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500134', '2', '12', '3', '3', '1', '2', '3', '2', '5', '17', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500135', '2', '12', '3', '3', '1', '1', '2', '2', '4', '18.5', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500136', '2', '12', '3', '3', '1', '1', '3', '2', '4', '18', '2', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');
insert into tp_alumno_evaluado (cod_alumno,sexo,edad,cod_contextura,cod_estatura,cod_familia,orden_nacimiento,cant_hnos,nivel_escolar,grado_escolar,promedio_escolar,cant_cambio_colegio,cod_religion,cod_nacionalidad,cod_distrito,cod_provincia,cod_departamento,cod_perfil,cod_estado) values ('A201500137', '2', '12', '3', '3', '1', '2', '2', '1', '6', '18', '1', '1', '1', '5', '1', '1', 'P0000', 'ALU0002');



--Data Comun
-- Perfiles
Select cod_perfil, nom_perfil from tp_perfil where deshabilitado = false;

--Alumnos Evaludos
Select 
            a.cod_alumno as "Alumno",
            b.nom_perfil as "Perfil",
            --(select parametro from tp_config where parametro like 'service.sexo.%' and valor = a.sexo) as "sexo",
	    CASE WHEN a.sexo = '1' THEN 'Masculino' ELSE 'Femenino 'END as "Sexo",
edad as "Edad",
            (select nom_contextura from tp_contextura where cod_contextura = a.cod_contextura) as "Contextura",
            (select nom_estatura from tp_estatura where cod_estatura = a.cod_estatura) as "Estatura",
            (select nom_familia from tp_tipo_familia where cod_familia = a.cod_familia) as "Tipo Familia",
orden_nacimiento as "Orden Nacimineto",
cant_hnos as "Num Hnos",
            --(select parametro from tp_config where parametro like 'service.nivelEscolar.%' and valor = a.nivel_escolar) as "nivelEscolar.codigo",
	    CASE WHEN a.sexo = '1' THEN 'Primaria' ELSE 'Secundaria 'END as "Nivel Escolar",
grado_escolar as "Grado",
promedio_escolar as "Promedio",
cant_cambio_colegio as "Num. Cambios",
            (select nom_religion from tp_religion where cod_religion = a.cod_religion) as "Religion",
            (select nom_distrito from tp_distrito where cod_distrito = a.cod_distrito) as "Distrito",
            (select nom_departamento from tp_departamento where cod_departamento = a.cod_departamento) as "Departamento",
            (select nom_provincia from tp_provincia where cod_provincia = a.cod_provincia) as "Provincia",
            (select nom_nacionalidad from tp_nacionalidad where cod_nacionalidad = a.cod_nacionalidad) as "Nacionalidad"
from tp_alumno_evaluado a inner join tp_perfil b on a.cod_perfil = b.cod_perfil
where cod_estado = 'ALU0002'
and cod_alumno between 'A201500101' and 'A201500137'
order by a.cod_perfil asc, a.cod_alumno desc;

--Alumnos Postulantes
Select 
            a.cod_alumno as "Alumno",
            a.nombres as "Nombres",
            a.apellido_pat as "Apellido Paterno",
            a.apellido_mat as "Apellido Materno",
            CASE WHEN a.sexo = '1' THEN 'Masculino' ELSE 'Femenino 'END as "Sexo",
edad as "Edad",
            (select nom_contextura from tp_contextura where cod_contextura = a.cod_contextura) as "Contextura",
            (select nom_estatura from tp_estatura where cod_estatura = a.cod_estatura) as "Estatura",
            (select nom_familia from tp_tipo_familia where cod_familia = a.cod_familia) as "Tipo Familia",
orden_nacimiento as "Orden Nacimineto",
cant_hnos as "Num Hnos",
            CASE WHEN a.sexo = '1' THEN 'Primaria' ELSE 'Secundaria 'END as "Nivel Escolar",
grado_escolar as "Grado",
promedio_escolar as "Promedio",
cant_cambio_colegio as "Num. Cambios",
            (select nom_religion from tp_religion where cod_religion = a.cod_religion) as "Religion",
            (select nom_distrito from tp_distrito where cod_distrito = a.cod_distrito) as "Distrito",
            (select nom_departamento from tp_departamento where cod_departamento = a.cod_departamento) as "Departamento",
            (select nom_provincia from tp_provincia where cod_provincia = a.cod_provincia) as "Provincia",
            (select nom_nacionalidad from tp_nacionalidad where cod_nacionalidad = a.cod_nacionalidad) as "Nacionalidad"
from tp_alumno_postulante a
where cod_alumno between 'A201600001' and 'A201600004'
order by a.cod_perfil asc, a.cod_alumno desc;
